[dynet] initializing CUDA
[dynet] CUDA driver/runtime versions are 11.1/11.1
Request for 1 GPU ...
[dynet] Device Number: 0
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 1
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 2
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 3
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 4
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 5
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 6
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device Number: 7
[dynet]   Device name: Tesla V100-PCIE-16GB
[dynet]   Memory Clock Rate (KHz): 877000
[dynet]   Memory Bus Width (bits): 4096
[dynet]   Peak Memory Bandwidth (GB/s): 898.048
[dynet]   Memory Free (GB): 16.5544/16.9455
[dynet]
[dynet] Device(s) selected: 0
[dynet] random seed: 3244598375
[dynet] using autobatching
[dynet] using profiling level 2
[dynet] allocating memory: 512MB
[dynet] memory allocation done.
digraph G {
  rankdir=LR;
  nodesep=.05;
  N0 [label="v0 = parameters({3,2}) @ 0x150b2c0 (MEM:     0.04688 KiB)"];
  N1 [label="v1 = parameters({3}) @ 0x1c413950 (MEM:     0.02344 KiB)"];
  N2 [label="v2 = parameters({1,3}) @ 0x1c413ad0 (MEM:     0.02344 KiB)"];
  N3 [label="v3 = parameters({1}) @ 0x1c413c60 (MEM:    0.007812 KiB)"];
  N4 [label="v4 = constant({2}) (MEM:     0.01562 KiB)"];
  N5 [label="v5 = scalar_constant(0x1c414530) (MEM:    0.007812 KiB)"];
  N6 [label="v6 = v1 + v0 * v4 (MEM:     0.02344 KiB)"];
  N1 -> N6;
  N0 -> N6;
  N4 -> N6;
  N7 [label="v7 = tanh(v6) (MEM:     0.02344 KiB)"];
  N6 -> N7;
  N8 [label="v8 = v3 + v2 * v7 (MEM:    0.007812 KiB)"];
  N3 -> N8;
  N2 -> N8;
  N7 -> N8;
  N9 [label="v9 = || v8 - v5 ||^2 (MEM:    0.007812 KiB)"];
  N8 -> N9;
  N5 -> N9;
  N10 [label="v10 = constant({2}) (MEM:     0.01562 KiB)"];
  N11 [label="v11 = scalar_constant(0x1c4149f0) (MEM:    0.007812 KiB)"];
  N12 [label="v12 = v1 + v0 * v10 (MEM:     0.02344 KiB)"];
  N1 -> N12;
  N0 -> N12;
  N10 -> N12;
  N13 [label="v13 = tanh(v12) (MEM:     0.02344 KiB)"];
  N12 -> N13;
  N14 [label="v14 = v3 + v2 * v13 (MEM:    0.007812 KiB)"];
  N3 -> N14;
  N2 -> N14;
  N13 -> N14;
  N15 [label="v15 = || v14 - v11 ||^2 (MEM:    0.007812 KiB)"];
  N14 -> N15;
  N11 -> N15;
  N16 [label="v16 = constant({2}) (MEM:     0.01562 KiB)"];
  N17 [label="v17 = scalar_constant(0x150b1b0) (MEM:    0.007812 KiB)"];
  N18 [label="v18 = v1 + v0 * v16 (MEM:     0.02344 KiB)"];
  N1 -> N18;
  N0 -> N18;
  N16 -> N18;
  N19 [label="v19 = tanh(v18) (MEM:     0.02344 KiB)"];
  N18 -> N19;
  N20 [label="v20 = v3 + v2 * v19 (MEM:    0.007812 KiB)"];
  N3 -> N20;
  N2 -> N20;
  N19 -> N20;
  N21 [label="v21 = || v20 - v17 ||^2 (MEM:    0.007812 KiB)"];
  N20 -> N21;
  N17 -> N21;
  N22 [label="v22 = constant({2}) (MEM:     0.01562 KiB)"];
  N23 [label="v23 = scalar_constant(0x1c4151c0) (MEM:    0.007812 KiB)"];
  N24 [label="v24 = v1 + v0 * v22 (MEM:     0.02344 KiB)"];
  N1 -> N24;
  N0 -> N24;
  N22 -> N24;
  N25 [label="v25 = tanh(v24) (MEM:     0.02344 KiB)"];
  N24 -> N25;
  N26 [label="v26 = v3 + v2 * v25 (MEM:    0.007812 KiB)"];
  N3 -> N26;
  N2 -> N26;
  N25 -> N26;
  N27 [label="v27 = || v26 - v23 ||^2 (MEM:    0.007812 KiB)"];
  N26 -> N27;
  N23 -> N27;
  N28 [label="v28 = v9 + v15 + v21 + v27 (MEM:    0.007812 KiB)"];
  N9 -> N28;
  N15 -> N28;
  N21 -> N28;
  N27 -> N28;
}

Aggregated nodes, sorted by memory consumption:
   0.007812 KiB	1.724%	called 1x	a + a + a + a
   0.007812 KiB	1.724%	called 1x	parameters({1}) @ 0x1c413c60
   0.007812 KiB	1.724%	called 1x	scalar_constant(0x150b1b0)
   0.007812 KiB	1.724%	called 1x	scalar_constant(0x1c414530)
   0.007812 KiB	1.724%	called 1x	scalar_constant(0x1c4149f0)
   0.007812 KiB	1.724%	called 1x	scalar_constant(0x1c4151c0)
    0.02344 KiB	5.172%	called 1x	parameters({1,3}) @ 0x1c413ad0
    0.02344 KiB	5.172%	called 1x	parameters({3}) @ 0x1c413950
    0.03125 KiB	6.897%	called 4x	|| a - a ||^2
    0.04688 KiB	10.34%	called 1x	parameters({3,2}) @ 0x150b2c0
     0.0625 KiB	13.79%	called 4x	constant({2})
    0.09375 KiB	20.69%	called 4x	tanh(a)
      0.125 KiB	27.59%	called 8x	a + a * a
     0.4531 KiB	100%	(total)

Memory pool info for each devices:
 Device GPU:0 - FOR Memory 128MB, BACK Memory 128MB, PARAM Memory 128MB, SCRATCH Memory 128MB.
 Device CPU - FOR Memory 32MB, BACK Memory 32MB, PARAM Memory 32MB, SCRATCH Memory 32MB.
